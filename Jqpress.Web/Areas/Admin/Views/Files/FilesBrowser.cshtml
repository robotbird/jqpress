@using Syw.Framework.Mvc
@model Syw.Admin.Models.Files.ImageListModel
@{
    Layout =null;
 

   if (Model.ModelID!=1)
    {
        Layout = "~/Administration/Views/Shared/_AdminLayout.cshtml";
    }
  
    }
    <link href="@Url.Content("~/Administration/Content/layout.css")" rel="stylesheet" type="text/css" />
<style type="text/css">
 .imgright{ width:200px;  float:right; border:0px solid gray;  margin-top:0px;  }
 .imgright p{ margin:10px 0 0 10px;  }
 .imgleft{ _float:left; margin-right:200px !important;  _margin-right:-10px; } 

.upfile li{  float:left;  margin:5px 3px 25px 0;    width:90px; height:88px; border:0px solid #ccc; text-align:center;}
.upfile .current{   background:#f3f9f5;}
.upfile p{ margin:3px 0; overflow:hidden;text-overflow:ellipsis; white-space:nowrap; line-height:150%; }
.upfile a{   width:48px; height:48px;   }
.upfile img{ border:0px solid #ccc; }
.upfile .delete{position:relative;  width:20px; height:20px;   top:-92px;   right:-40px;  border:0px solid gray; color:Gray; font-size:10px; }
</style>
 <form name="aspnetForm" action="@Url.Action("SaveFiles", "Files", new { path = ViewBag.path })" method="post"  id="aspnetForm" enctype="multipart/form-data">
<div  class="imgright">   
    
    <h4>上传附件</h4>
    <p>当前路径：</p>
    <p><input type="file" id="FileUpload" name="FileUpload" style="width:180px" /> </p>
    <p><input type="checkbox" id="chkWatermark"  checked="true" />加水印(图片) <a href="blog_set.aspx#watermarks" class="small">水印详细设置</a> </p>
    <p>存在同名文件时:</p>
    <p> 
        <input type="radio" name="uploadtype" value="1" />跳过
        <input type="radio" name="uploadtype" value="2" />重命名
        <input type="radio" name="uploadtype" value="3" />覆盖
    </p>
    <p><input type="submit" value="上传" class="button" /> </p>
    <p class="notice" style=" word-wrap : break-word ;word-break : break-all ;overflow:auto;" title="@Model.AllowFileExtension">允许格式:<br />@Model.AllowFileExtension .</p>
  
</div>

<div class="imgleft" >
    <h4>当前位置:  @Html.Raw(Model.PathUrl)</h4>
    <ul class="upfile">
        @foreach (var d in Model.FoldList)
        {
        <li>
            <a href="@ViewBag.UrlPath?path=@d.FoldPath/@d.FoldName" title="点击打开此文件夹"><img src="/content/images/folder.png"  alt="点击打开此文件夹" width="48" height="48"/></a>
             <p class="small">
                <span title="文件夹:@d.FoldName" >@d.FoldName</span>
                <br />
                <span class="gray">
                @d.FileSystemInfosLength 个文件
                </span>
             </p>
        <a class="delete" href="/admin/files/DeleteFile?path=@ViewBag.path/@d.FoldName&url=@ViewBag.path"  title="删除" onclick=" return confirm('确定要删除 @d.FoldName  吗?');">X</a>
        </li>
        } 

     @foreach (var f in Model.FileList)
     {
        <li>
             <a href="@f.FileUrl" target="_blank" onclick=" return returnValue('@f.FileUrl','@f.Extension');">
                <img src="@f.FileUrl" width="48" height="48"/>
             </a>
                <p class="small">
                <span title="@f.FileName" >@f.FileName</span>
                <br />
                <span class="gray">@f.FileLength</span>
                </p>
        <a class="delete" href="/admin/files/DeleteFile?path=@f.FilePath&url=@ViewBag.path"  title="删除" onclick=" return confirm('确定要删除 @f.FileName  吗?');">X</a>
        </li>
        
     } 
    
    @if (Model.FileList.Count == 0 && Model.FoldList.Count ==0)
    { <p>还没有上传任何附件!</p> }
    </ul>
    <div style="clear:both;text-align:center;">
@if (Model.FileList.Count == 0)
{
  @Html.Pager(Model.FoldPageList)
} 
  </div>
</div>

  </form>

<script type="text/javascript">

    function returnValue(fileUrl, fileExtension) {

    if(window.opener!=undefined){
       window.opener.document.getElementById("src").value=fileUrl;
       window.close();
       return false;
    }else{
        parent.addFileToEditor(fileUrl,fileExtension) ;
        parent.tb_remove();
        return false;
    }

}
</script>

